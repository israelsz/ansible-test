version: '3.8'

services:
  api:
    image: {{ api_image | default('nginx') }}:{{ api_version | default('latest') }}
    ports: ["3001:3001"]
    environment:
      - NODE_ENV=production

  web:
    image: {{ web_image | default('nginx') }}:{{ web_version | default('latest') }}
    ports: ["8080:80"]

  nginx:
    image: nginx:{{ nginx_version | default('latest') }}
    ports: ["80:80", "443:443"]
    depends_on: [api, web]